Installation instructions for the toolchain can be found in ../../


## Compile & test the usecases

The file ```makefile.config``` specifies the path of the different tools
we need.

Each of our usecases may be compiled using the ```make``` command and
executed using the ```make run-[driver]``` command. The 
```make benchmar-driver``` executes the iree benchmark tool.
Three drivers are supported for now, depending on your local setup :
* dylib (CPU)
* cuda (GPU)
* vulkan (GPU)

We present 4 usecases :
1- ```resnet50```, a network focused on image recognition wich has a lot (50)
   of deep layers. If needed, the ```make``` command obtains the trained
   weights of the network from the Google repository.
2- ```kws-lstm```, a recurrent neural network for keyword-spotting using LSTM.
   The command ```make``` produces a network whose weights are set to 0
   (we have not trained it yet).
3- ```timeseries```, a recurrent neural network operating on scalars using an other
   implementation of LSTM. The model comprises an RNN layer (LSTM) followed by
   two fully-connected (Dense) layers. Its Python specification is timeseries.py.
   In this file, we have set the length of the time series to 5.
4- ```demo```, an LSTM-based test of modularity during iree-based compilation.

We provide for example the compilation instructions for the
```timeseries``` example.  Its lus dataflow is generated by typing
```python3 timeseries.py```, where the native keras API is overriden
by keras-lus.  The different MLIR lowering steps are implicitly invoked by
the ```Makefile```.  The C driver making invocations of the IREE VM code
is in ```main.c```.

Before invoking ```make```, check that the variables in ```makefile.config```
correspond to your system.

The compilation and execution objective is different according to the execution
target:
* For CPU, using the ```dylib``` driver: ```make run-dylib```
* For GPU, using the CUDA driver (on NVidia GPUs): ```make run-cuda```
* For GPU, using the Vulkan driver: ```make run-vulkan```

The command ```make``` without specified objectives will compile all 3 targets,
but not launch execution on any of them.

<!--
1- ```mnist```, a very simple convolutional network which recognizes
   handwritten-numbers. If needed, the ```make``` command generates the
   trained weights of the network.
5- ```lovecraft```, a recurrent neural network using LSTM in order to generate
   words. If needed, the ```make``` command generates the  trained weights of
   the network. [TODO]
-->